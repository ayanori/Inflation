clear
format long

    lon = [-166.94045499970332, -166.74834499953678, -166.78787999952465, -166.54183600062353]';
    lat = [53.80809500027836, 53.809592999967826, 53.914693000449454, 53.875635000401964]';
    % alt = [331.80000490235057, 786.7000352857419, 431.10004154835644, 105.67728634424256]';

%%
[E,N] = ll2xy(lon,lat,1);
%%
lonRef = -166.54848600066168;
latRef = 53.905013000620606;
% altRef = 106.50004512297782;

% best_x = -22258.5094863199;
% best_y = -2249.3561617934;
% best_d = 5483.1824698716;
% best_C = 535289.1252828458;
best_x = -22200;
best_y = -3150;
best_d = 5200;
best_C = 490280;

x = E - best_x;
y = N - best_y;

xs = [x;0];
ys = [y;0];
[dx,dy,dz] = mogi1(xs,ys,best_d,best_C);

% xRef = -best_x;
% yRef = -best_y;
% [dxRef,dyRef,dzRef] = mogi1(xRef,yRef,best_d,best_C);
%%
d00 = [dx-dxRef,dy-dyRef,dz-dzRef];
disp(1000*d00);

%    -22874.6240353526  -2265.4749230181    6578.1889041095 540093.3620999814
% 
% 95% confidence interval for m1 is [-24876.1318,-21660.3853]
% 95% confidence interval for m2 is [-3767.0627,-48.5681]
% 95% confidence interval for m3 is [4723.259,9547.9326]
% 95% confidence interval for m4 is [405192.2883,854373.5394]
%
% -166.9286377854486    53.871059073833877
% 
% -166.8794954275761    53.904575238405613
